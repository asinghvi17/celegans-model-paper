\documentclass[
    11pt,
]{article}

\usepackage{authblk}

% \usepackage{natbib}
% \setcitestyle{nature}

\usepackage[style=nature, natbib]{biblatex}

\addbibresource{References.bib}

\input{preamble.tex}

\tikzexternalize

\begin{document}
% \sffamily

%==============================================================================%
%                              Title and abstract                              %
%==============================================================================%

\title{A minimal reaction-diffusion neural model generates {\emph{C. elegans}} undulation}

\author[1]{Anshul Singhvi}

\author[1,3]{Harold Hastings}

\author[2]{Jenny Magnes}

\author[2]{Cheris Congo}

\author[2]{Miranda Hulsey-Vincent}

\author[1]{Rifah Tasnim}

\author[1]{Naol Negassa}

\affil[1]{Bard College at Simon's Rock}
\affil[2]{Vassar College}
\affil[3]{Hofstra University}

\date{\today}

\begin{abstract}
    The small (1 mm) nematode \emph{Caenorhabditis elegans} has become widely used as a model organism; in particular the \emph{C. elegans} connectome has been completely mapped, and \emph{C. elegans} locomotion has been widely studied (c.f. http://www.wormbook.org \citet{corsi2015}). We describe a minimal reaction-diffusion model for the \emph{C. elegans} central pattern generator (CPG) \citet{xu2018,wen2012}. We use simulation methods to show that a small network of \citet{fitzhugh1955}-\citet{nagumo1962} neurons (one of the simplest neuronal models) can generate key features of \emph{C. elegans} undulation (see \citet{magnes2012}), and thus locomotion. Compare the neuromechanical model of \citet{izquierdo2018}. We also investigate dynamics and stability of the model.
    % TODO: expand and inflate; fix grammar
\end{abstract}

\maketitle

\section{Introduction}\label{sec: intro}


The small (1 mm) nematode \emph{Caenorhabditis elegans} (\emph{C. elegans}) has become widely used as a model organism \citep{corsi2015}, and has been among the most widely studied biological models of neuronal development, locomotion and the central pattern generator \citep{katz2016}.
The C. elegans connectome has been completely mapped \citep{jabr} and, as described below, its locomotion has been widely studied.
``When crawling on a solid surface, the nematode C. elegans moves forward by propagating sinusoidal dorso-ventral retrograde contraction waves. A uniform propagating wave leads to motion that undulates about a straight line.'' \citep{kim2011}.
A different type of locomotion, often called swimming, occurs when nematodes are submerged in a liquid medium. The nematodes “switch” between these two gaits, under the regulation of particular serotonergic and dopaminergic neurons.

% TODO:
% - decide whether to cite CPG
% - italicise C. elegans
The purpose of this paper to describe a minimal reaction-diffusion model for the \emph{C. elegans} central pattern generator (CPG) \citep{xu2018, wen2012}. We use simulation methods to show that a small network of \citet{fitzhugh1955}-\citet{nagumo1962} neurons (one of the simplest neuronal models) based on a skeleton model of the C. elegans CPG can reproduce key features of C. elegans undulation \citep{magnes2012} and thus locomotion.

In addition to simulating the CPG, we also implemented a modified version of the FitzHugh-Nagumo neuron, originally proposed by \citet{keener1983}, as an analog circuit.  This circuit solves the Keener differential equations, and we adjusted it to allow diffusive coupling between neurons.  We made a small network with these ``neuro-mimetic'' circuits, and showed that their behaviour replicates FitzHugh-Nagumo simulated behaviour.

\section{The model central pattern generator}

% TODO confirm the Xu reprint policy

A central pattern generator is a small neural circuit which generates and regulates the movement of complex organisms.  This structure is present in different forms in many animals, and it regulates many types of periodic motion.  \citet{xu2018} proposed an architecture for the CPG of \emph{C. elegans} which is described below in \fref{fig: xu_cpg}.

In more complex animals, like horses or humans, there is only one CPG; the dynamics of the CPG change depending on the gait of the animal \citep{collins1994}.  We show later that breaking the symmetry of the CPG model can lead to radical changes in behaviour.

\begin{figure}[h!]
    \label{fig: xu_cpg}
    \centering
    \includegraphics[width=9cm]{figures/xu_cpg/xu_cpg.png}
    \caption{Pirated from Xu.}
\end{figure}

The central pattern generator has two principal components.  First is the \textbf{head oscillator}. As described by \citet{gjorgjieva2014}, the head oscillator consists of two “head neurons” with mutually inhibitory coupling.  Oscillations are generated when this coupling destabilizes an excitable steady state.
% This is destablilzing to a stable limit cycle.  Mutual inhibition leads to a 180-deg out of phase oscillation - describe this in more detail.
% TODO experiment on a single head oscillator.
% TODO explain how coupling works

Second is the \textbf{descending pathway}, which consists of pairs of coupled, excitable, dorsal and ventral neurons.  These follow the body of the worm, and are linked to motor neurons and muscles.  The head oscillator drives the descending pathway, and the pathway is kept in sync by mutual inhibitory coupling between neurons.

One can think of the CPG as a driven, dissipative system.  An analogy to the driven, damped oscillator is particularly apt - in the CPG, the head oscillator drives the descending pathway.

While \textit{C. elegans} has twelve pairs of motor neurons, we have only used six pairs in our model.  \Fref{fig: cpg} is a depiction of our simplified model as a graph, wherein neurons are nodes, and the arrows between them symbolize connections.

\begin{figure}[h!]
    \label{fig: cpg}
    \centering
    \inputtikz{figures/cpg/cpg}
    \caption{Our simplified central pattern generator model.  Descending coupling (shows inhibitory connections, and potential flows through gap junctions, not necessarily symmetric)}
\end{figure} % TODO: legend

\section{The FitzHugh-Nagumo Neuron}\label{sec: fhn}

In accord with the goal of this paper, we sought the simplest relevant neuronal model.  The classical Hodgkin-Huxley\cite{hodgkin1952} model of squid neurons has led to a variety of simpler conduction models, including the Morris-Lecar\cite{morris1981} and Fitzhugh-Nagumo models.

The FHN model consists of two dynamical variables; a fast activator variable $v$ corresponding to the (rescaled) membrane potential, and a slow inhibitor variable $w$ corresponding to a generalized gating variable.

\begin{equation} % reference HH model here as well
    \label{eq: fhn}
    \begin{aligned}
        dv &= f(v) + w - I_\mathrm{ext}\\
        dw &= ϵ(a - bv)\\
        f(v) &= \frac{v^3}{3} - v
    \end{aligned}
\end{equation}

% The sodium channel has a negative resistance regime, wherein the current decreases as the voltage increases.  Nagumo's tunnel diode describes the same behaviour.  The point is that in the oscillatory regime the system is a relaxation oscillator, and that it has an excitable regime.

In this system, $f(v)$ can be any function which retains the appropriate dynamics, in that it has the same general shape as the cubic $f(v)$.  In our analog implementation, we use a piecewise linear approximation to the cubic, in order to simplify the circuit and avoid using expensive components.  Here, the position of the $w$-nullcline is controlled by $a$, and the vertical translation of the $v$-nullcline is controlled by $I_{ext}$

Xu et al. used a simplified two-variable model consisting of a fast, cubic-like activator variable (see the V-nullcline) and a slow, non-linear inhibitor variable (see the n-nullcline). BothThe Fitzhugh-Nagumo model has similar activator nullclines.

% TODO: remove Morris-Lecar
% remark that if the w and v nullclines come near each other, you see a critical slowdown.
% In Hodgkin-Huxley notation, $n$ is the potassium channel.  In the FHN formulation, this corresponds to the $w$ gate variable.
\begin{figure}[h!]
    \label{fig: nm nullclines}
    \centering
    \inputtikz{figures/neuron_dynamics/neuron_dynamics}
    % TODO: change legend to dv/dt=0, dw/dt=0
    % relabel ``real c. elegans'' to C. elegans (experimental data).
    % for publication: remove ticklabels, keep minor grid
    \caption{Nullclines of several different neuronal models; on the right is the biological model of Xu et al, in the centre is the Morris-Lecar model, and to the right is the FitzHugh-Nagumo model.  These have been arranged in order of decreasing complexity.}
\end{figure} % TODO: legend

The original system was meant to model one neuron only.  We use diffusion to
model a synapse. A positive coefficient would simulate a gap junction or
an excitatory synapse; a negative coefficient would simulate inhibitory
coupling (\citet{collins1994}).

% TODO: there will be other examples...cf them

The equations, when modified for synaptic connections, look like this:

\begin{equation}
    \label{eq: fhnd}
    \begin{aligned}
        dv   &= f(v) + w - I_\mathrm{ext} + D(Δv)\\ % highlight D?
        dw   &= ϵ(a - bv)\\
        f(v) &= \frac{v^3}{3} - v
    \end{aligned}
\end{equation}

\begin{figure}[h!]
    \label{fig: fhn_dynamics}
    \centering
    \inputtikz{figures/fhn_dynamics/fhn_dynamics}
    % TODO describe this more.
    % Show a sample trajectory in each of these.
    % remove the ticklabels
    % condense into single figure
    % .
    \caption{The nullclines of the FitzHugh-Nagumo neuron.  Nullclines are isoclines where the derivative of a variable is zero.  Here we show an oscillatory mode and an excitable one.  In an oscillating cell, the stable equilibrium is replaced by an unstable equilibrium (open circle) around which it circles indefinitely.  See \citet{parsons2018} for a clear explanation of the dynamics of oscillatory biological systems.}
\end{figure} % TODO: legend



\section{Simulation}

The simulation was performed in Python, using the standard SciPy ODE solvers, which wrap LSODA. % TODO list solver here

\subsection{Methods}

See the appendix, or attached code, for how we simulated this motion.  It should probably also be published on Github - I could make a Jupyter notebook with it.

We realize the network shown in \Fref{fig: cpg} into a system of ODEs, and solve it.  The equations are integrated, giving a timeseries of neuronal potentials.  These are passed through filters to simulate muscular movement and the resistance of the medium.  We used Gaussian smoothing and B-splines for this purpose.

We generated a video by fixing the head of a worm to the origin, and re-normalizing the coordinates resulting from the filtering.

\subsection{Comparison to real worm}

Cite the paper which Jenny sent here.  It can be seen that our model closely approximates an unconstrained worm, specifically of the wild type.

While the angle which a worm crawling on agar subtends tends to be oblique, as the constraint on the worm decreases, the angle becomes more and more acute - consider the videos . It is not hard to see that a fully unconstrained worm might behave much like our model does.

\section{Analog implementation}

\citet{nagumo1962} proposed a circuit to simulate a FitzHugh-Nagumo neuron, shown in \Fref{fig: nagumo_ckt}.  It used a tunnel diode to achieve a cubic-like activation function, and an inductor to integrate.  However, this approach presents several complications.  Tunnel diodes are rare, and rather expensive; inductors cannot be used in proximity because of mutual inductance effects, and are quite large.

\begin{figure}[h!]
    \centering
    \inputtikz{figures/nagumo/nagumo}
    \caption{The original circuit proposed by \citet{nagumo1962}.  Note the use of inductors for integration, and the tunnel diode to supply a cubic-like V-I curve.  Our circuit, based off \citet{keener1983}, is arranged in the same layout, to make the similarities and differences more explicit.}
    \label{fig: nagumo_ckt}
\end{figure}

\citet{keener1983} proposed a modified Nagumo circuit which used operational amplifiers ("op-amps") to achieve nonlinearity and create a piecewise linear function.  He used an op-amp under saturation to create a piecewise linear approximation to the cubic, which is sufficient to drive the FHN oscillator.  He also used an op-amp integrator to simulate an inductor.

As a result of the piecewise linear approximation to the cubic, the nullclines of the circuit system differ slightly from the original FitzHugh-Nagumo nullclines.  However, in experiments this did not cause any change in the dynamics of the individual neuron, or many connected together - the nullclines are sufficiently similar that the dynamics are effectively the same.

Our modifications to Keener's proposed circuit are mainly concerned with diffusive coupling between neurons.  If each individual circuit is thought of as a single neuron, then we implemented diffusive coupling methods between those neurons.  We also found that you don't need separate power supplies, and you can get finer control by adjusting the bias voltage and input through a separate mechanism.

\begin{figure}[h!]
    \centering
    \inputtikz{figures/neuron_unit/neuron_unit}
    \caption{The circuit we created, based of \citet{keener1983}.  Note the use of operational amplifiers in place of the inductor and tunnel diode; though this circuit looks more complex, in practice it is quite simple to implement.}
    \label{fig: neuron_unit}
\end{figure}

However, this is only one neuron.  In order to implement a full central pattern generator, we implemented diffusive coupling mechanisms.  These mechanisms are shown in \Fref{fig: coupling_ckt}.  We implemented a positive diffusion coefficient by passing the voltage through a resistor (to simulate $D$), and then a diode (to simulate $\mathrm{max}(\Delta v, 0)$).  The negative diffusion coefficient was implemented by using an inverting amplifier with a small gain, and then passing through a diode.

\subsection{Comparison of analog and simulation}

To compare the analog implementation with our simulated model, we will focus on the timeseries output of the neurons, and not on the end worm.  Include the relevant figure here - you can see clearly that the effect is the same.  There are some differences in the waveform because of the different activation function in the circuit (linear interpolation).

% \begin{figure}
%
% \end{figure}

\section{Conclusion}

Mention the bullet points from the presentation.  How could a system like this be used in applications?  End with some future paths.

Reference some connections to \citet{adamatzky2008} - the neural system as a computational system.  Also cite similarity between B-Z and FHN.

\section{References}

% \nocite{*}
% \bibliography{References}
\printbibliography[heading=none]
\end{document}
